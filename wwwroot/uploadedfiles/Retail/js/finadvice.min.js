//##############################################################
// ############  M A P    I N F O R M A T I O N     F O R     T H E     A D V I S O R ############
//##############################################################

var map = null;
var selectedMarker = 14;
var consultantMarker = null;

function createConsultantMarker()
{
					consultantMarker = createMarker(thisAdviserData.locations[0], thisAdviserData);
					log('marker created ' + consultantMarker.longitude + ' ' + consultantMarker.latitude);
}

function addConsultantToMap()
{
					map.addOverlay(consultantMarker);
					openBubble(consultantMarker);
}

var consultantMarkerImage = "http://www.irishlife.ie/v2/img/marker/markerPurple.png";

function openBubble(marker)
{

	log('map zoom ' + map.getZoom());
	map.setCenter(new GLatLng(new Number(marker.latitude), new Number(marker.longitude)), selectedMarker);
		
	clickedMarker = marker;
	
	marker.openInfoWindowHtml(marker.info);
}

function createMarker(markerData, consultantData) 
{
	log('creating a marker');
	var markerIcon = new GIcon();
	
	markerIcon.image = consultantMarkerImage;	
	
	markerIcon.iconSize = new GSize(20, 34);
	markerIcon.iconAnchor = new GPoint(10, 34);
	markerIcon.infoWindowAnchor = new GPoint(10, 17);
	
	m_opts = { icon:markerIcon };
	var location = new GLatLng(markerData['latitude'], markerData['longitude']);
	var marker = new GMarker(location, m_opts);
	
	GEvent.addListener(marker,"click",function() 
	{
		openBubble(marker);
	});
	
	marker.latitude = markerData['latitude'];
	marker.longitude = markerData['longitude'];
	marker.info = generateConsultantInfo(markerData, consultantData);
	
		
	return marker;
}

function generateConsultantInfo2(data, consultantData)
{
	return '';
}

function generateConsultantInfo(data, consultantData)
{
	var html = '<div class="markerInfo markerInfoConsultant">';
	html += '<h3>' + consultantData['firstname'] + ' ' + consultantData['lastname'] + '</h3>';
	html += '<div class="markerInfoAddress" >';
	html += consultantData['address1'] + '<br />' + 
	consultantData['address2'] + '<br />' + 
	consultantData['address3'] +'<br />' + 
	consultantData['address4'] +'</div></div>';
	log('consultant info ' + html);
	return html;
}
function initialiseMap()
{
	if($("#mapCanvas").length)
	{
		if(GBrowserIsCompatible()) 
		{
			// Set the defaults for the Google Map
			map = new GMap2(document.getElementById("mapCanvas"));
			map.setCenter(new GLatLng(53.402982, -7.624512), 10);
			
			geocoder = new GClientGeocoder();
			
			// Add map controls
			var uiOptions = map.getDefaultUI();
			uiOptions.maptypes.satellite = false;
			uiOptions.maptypes.physical = false;
			uiOptions.controls.scalecontrol = false;
			map.setUI(uiOptions);
			
			$(window).unload(function () { GUnload(); });
		}
	}
}
function showMap()
{
		initialiseMap();
		createConsultantMarker();
		addConsultantToMap();
}

//##############################################################
// #################  S E T    U P    T H E     A D V I S O R     D A T A   ################
//##############################################################
$(document).ready(function(){


$('#adviserPhoto').html(thisAdviserData.photo);
$('#adviserName').html(thisAdviserData.firstname + ' ' + thisAdviserData.lastname);
$('#adviserAddress').html(thisAdviserData.address1 + '<br />' + thisAdviserData.address2 + '<br />' +  thisAdviserData.address3 + '<br />' +  thisAdviserData.address4 + '<br />');
$('#adviserPhone').html(thisAdviserData.phone);
$('#adviserEmail').html('<a href=\"mailto:' + thisAdviserData.email + '\">' + thisAdviserData.email +'</a>' );
$('#adviserFax').html(thisAdviserData.fax);showAllAbout();
$('#adviserComments').html(thisAdviserData.comments);
$('#youtubeVideo').html(thisAdviserData.smallvideo);
$('#video-modal-content').html(thisAdviserData.largevideo);
$("#news").newsTicker();
 
if (thisAdviserData.about == '')
{
	$('#aboutMe').addClass('hidden');
}
 
if (thisAdviserData.comments == '')
{
	$('#comments').addClass('hidden');
}
if (thisAdviserData.smallvideo == '')
{
	$('#adviserVideo').addClass('hidden');
}
});
 
function showAllAbout()
{
	/*$('#adviserAbout').html(thisAdviserData.about.substring(0,thisAdviserData.about.length - 4)
	+ ' [<a class="open" href="javascript:void(0);" onclick="showAbout();">less</a>]</p>');*/
	$('#adviserAbout').html(thisAdviserData.about+'</p>');
}
 
function showAbout()
{
if (thisAdviserData.about.length > 300)
{
	$('#adviserAbout').html(thisAdviserData.about.substring(0,300) + '... [<a class="open" href="javascript:void(0);" onclick="showAllAbout();">more</a>]</p>');
}
else
{
	$('#adviserAbout').html(thisAdviserData.about);
}
 
}
$(document).ready(function(){ 
 $.getScript("http://s7.addthis.com/js/250/addthis_widget.js#username=irishlifedotie"); 

 });

function showadvicevid(){	
	$("#video-modal-content").dialog({modal: true, height:450,width:700});
}

eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('(1($){$.9.D=$.9.g=1(b){b=b||p;i=1(a){j(a);a.4=$("r",a);a.4.q(":o(0)").l().C();a.5=0;h(a)};h=1(a){a.m=t(1(){f(a)},b)};j=1(a){s(a.m)};8=1(a){a.3=7};d=1(a){a.3=c};f=1(a){e(a.3)6;a.3=7;$(a.4[a.5]).n("k",1(){$(2).l();a.5=++a.5%(a.4.B());$(a.4[a.5]).z("k",1(){a.3=c})})};2.y(1(){e(2.x.w()!="A")6;i(2)}).v("g").u(1(){8(2)},1(){d(2)});6 2}})(E);',41,41,'|function|this|pause|items|currentitem|return|true|pauseTicker|fn|||false|resumeTicker|if|doTick|newsticker|startTicker|initTicker|stopTicker|slow|hide|tickfn|fadeOut|eq|4000|not|li|clearInterval|setInterval|hover|addClass|toLowerCase|nodeName|each|fadeIn|ul|size|end|newsTicker|jQuery'.split('|'),0,{}))